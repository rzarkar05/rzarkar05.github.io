<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>4124c407735143389327911c44a8cbad</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="6" id="mYDt_TQwndiv">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="spotify-machine-learning-project" class="cell markdown"
id="jzS6Q_oYTOOe">
<h1><strong>Spotify Machine Learning Project</strong></h1>
<p><strong>Authors:</strong> Vraj Patel: 118788272, Rishi Zarkar:
118842974, Shreyas Ambarkar: 118762791</p>
<p>####<strong>Main Question:</strong> What insights can be derived from
analyzing the audio features of a song, and how can these insights
inform our understanding of the song's popularity, genre classification
and could it be used to reccomend similar songs?</p>
<p>This project aims to explore and analyze various musical features to
determine their impact on a song's popularity, explicitness, and
category. By examining audio attributes such as energy, danceability,
loudness, tempo, etc. we seek to uncover patterns and relationships that
could explain why certain tracks resonate more with audiences.</p>
<hr />
<p>#Outline:</p>
<h3 id="data-preproccessing">Data Preproccessing</h3>
<h3 id="general-data-exploration">General Data Exploration</h3>
<h3 id="explicit-song-classification">Explicit Song Classification</h3>
<h3 id="song-popularity-predictor">Song Popularity Predictor</h3>
<h3 id="recommendation-engine">Recommendation Engine</h3>
</section>
<div class="cell markdown" id="PRc9RlVNy37w">
<p>#Imports</p>
</div>
<div class="cell code" data-execution_count="7" id="frhDHdwB0IjS">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> cdist</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> euclidean_distances</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_samples</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFE</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score, confusion_matrix</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="Q5PfmiZCBy0s">
<hr />
</div>
<section id="data-cleaning-and-preprocessing" class="cell markdown"
id="DczTSxdICNWx">
<h1>Data Cleaning and Preprocessing</h1>
</section>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="nj0xn-gTCwZ5" data-outputId="f28ed67c-6bab-4f92-a0b2-048c91c5b753">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:434}"
id="8k1IczUhbIBF" data-outputId="e531162e-5c97-4f41-ee7e-cd6356ee8e6d">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">&#39;/content/drive/MyDrive/data 2.csv&#39;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-e2c9a420-e165-4e5c-9fb7-e538a19af8c4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>artists</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>explicit</th>
      <th>id</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>name</th>
      <th>popularity</th>
      <th>release_date</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>valence</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.995</td>
      <td>['Carl Woitschach']</td>
      <td>0.708</td>
      <td>158648</td>
      <td>0.1950</td>
      <td>0</td>
      <td>6KbQ3uYMLKb5jDxLF7wYDD</td>
      <td>0.563</td>
      <td>10</td>
      <td>0.1510</td>
      <td>-12.428</td>
      <td>1</td>
      <td>Singende Bataillone 1. Teil</td>
      <td>0</td>
      <td>1928</td>
      <td>0.0506</td>
      <td>118.469</td>
      <td>0.7790</td>
      <td>1928</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.994</td>
      <td>['Robert Schumann', 'Vladimir Horowitz']</td>
      <td>0.379</td>
      <td>282133</td>
      <td>0.0135</td>
      <td>0</td>
      <td>6KuQTIu1KoTTkLXKrwlLPV</td>
      <td>0.901</td>
      <td>8</td>
      <td>0.0763</td>
      <td>-28.454</td>
      <td>1</td>
      <td>Fantasiestücke, Op. 111: Più tosto lento</td>
      <td>0</td>
      <td>1928</td>
      <td>0.0462</td>
      <td>83.972</td>
      <td>0.0767</td>
      <td>1928</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.604</td>
      <td>['Seweryn Goszczyński']</td>
      <td>0.749</td>
      <td>104300</td>
      <td>0.2200</td>
      <td>0</td>
      <td>6L63VW0PibdM1HDSBoqnoM</td>
      <td>0.000</td>
      <td>5</td>
      <td>0.1190</td>
      <td>-19.924</td>
      <td>0</td>
      <td>Chapter 1.18 - Zamek kaniowski</td>
      <td>0</td>
      <td>1928</td>
      <td>0.9290</td>
      <td>107.177</td>
      <td>0.8800</td>
      <td>1928</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.995</td>
      <td>['Francisco Canaro']</td>
      <td>0.781</td>
      <td>180760</td>
      <td>0.1300</td>
      <td>0</td>
      <td>6M94FkXd15sOAOQYRnWPN8</td>
      <td>0.887</td>
      <td>1</td>
      <td>0.1110</td>
      <td>-14.734</td>
      <td>0</td>
      <td>Bebamos Juntos - Instrumental (Remasterizado)</td>
      <td>0</td>
      <td>1928-09-25</td>
      <td>0.0926</td>
      <td>108.003</td>
      <td>0.7200</td>
      <td>1928</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.990</td>
      <td>['Frédéric Chopin', 'Vladimir Horowitz']</td>
      <td>0.210</td>
      <td>687733</td>
      <td>0.2040</td>
      <td>0</td>
      <td>6N6tiFZ9vLTSOIxkj8qKrd</td>
      <td>0.908</td>
      <td>11</td>
      <td>0.0980</td>
      <td>-16.829</td>
      <td>1</td>
      <td>Polonaise-Fantaisie in A-Flat Major, Op. 61</td>
      <td>1</td>
      <td>1928</td>
      <td>0.0424</td>
      <td>62.149</td>
      <td>0.0693</td>
      <td>1928</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e2c9a420-e165-4e5c-9fb7-e538a19af8c4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e2c9a420-e165-4e5c-9fb7-e538a19af8c4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e2c9a420-e165-4e5c-9fb7-e538a19af8c4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c03c8bf9-90f4-4aa2-9554-bb2f22d9681f">
  <button class="colab-df-quickchart" onclick="quickchart('df-c03c8bf9-90f4-4aa2-9554-bb2f22d9681f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c03c8bf9-90f4-4aa2-9554-bb2f22d9681f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="IgH3DG3f_jxD" data-outputId="e5de515e-1aaf-417a-a5ed-365121e21da4">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>(169909, 19)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="j8DsLjFWALbA" data-outputId="7346234e-a40f-49bc-cd77-fded522ef6d3">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 169909 entries, 0 to 169908
Data columns (total 19 columns):
 #   Column            Non-Null Count   Dtype  
---  ------            --------------   -----  
 0   acousticness      169909 non-null  float64
 1   artists           169909 non-null  object 
 2   danceability      169909 non-null  float64
 3   duration_ms       169909 non-null  int64  
 4   energy            169909 non-null  float64
 5   explicit          169909 non-null  int64  
 6   id                169909 non-null  object 
 7   instrumentalness  169909 non-null  float64
 8   key               169909 non-null  int64  
 9   liveness          169909 non-null  float64
 10  loudness          169909 non-null  float64
 11  mode              169909 non-null  int64  
 12  name              169909 non-null  object 
 13  popularity        169909 non-null  int64  
 14  release_date      169909 non-null  object 
 15  speechiness       169909 non-null  float64
 16  tempo             169909 non-null  float64
 17  valence           169909 non-null  float64
 18  year              169909 non-null  int64  
dtypes: float64(9), int64(6), object(4)
memory usage: 24.6+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="4yhVboGqA5b0" data-outputId="be56cf3c-4e6d-4482-f4bd-204d98b48dfc">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>() <span class="co"># check for null values</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df.duplicated().<span class="bu">any</span>().<span class="bu">sum</span>() <span class="co"># check for duplicate  values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:320}"
id="7ossxniaA_n6" data-outputId="6c6b87b6-27b4-47ab-bee7-8fa677323fff">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-c7c4ad01-4ed3-429a-a3c7-6ce90fe5c925" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>explicit</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>popularity</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>valence</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>1.699090e+05</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
      <td>169909.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.493214</td>
      <td>0.538150</td>
      <td>2.314062e+05</td>
      <td>0.488593</td>
      <td>0.084863</td>
      <td>0.161937</td>
      <td>5.200519</td>
      <td>0.206690</td>
      <td>-11.370289</td>
      <td>0.708556</td>
      <td>31.556610</td>
      <td>0.094058</td>
      <td>116.948017</td>
      <td>0.532095</td>
      <td>1977.223231</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.376627</td>
      <td>0.175346</td>
      <td>1.213219e+05</td>
      <td>0.267390</td>
      <td>0.278679</td>
      <td>0.309329</td>
      <td>3.515257</td>
      <td>0.176796</td>
      <td>5.666765</td>
      <td>0.454429</td>
      <td>21.582614</td>
      <td>0.149937</td>
      <td>30.726937</td>
      <td>0.262408</td>
      <td>25.593168</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.108000e+03</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1921.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.094500</td>
      <td>0.417000</td>
      <td>1.710400e+05</td>
      <td>0.263000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.098400</td>
      <td>-14.470000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>0.034900</td>
      <td>93.516000</td>
      <td>0.322000</td>
      <td>1957.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.492000</td>
      <td>0.548000</td>
      <td>2.086000e+05</td>
      <td>0.481000</td>
      <td>0.000000</td>
      <td>0.000204</td>
      <td>5.000000</td>
      <td>0.135000</td>
      <td>-10.474000</td>
      <td>1.000000</td>
      <td>33.000000</td>
      <td>0.045000</td>
      <td>114.778000</td>
      <td>0.544000</td>
      <td>1978.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.888000</td>
      <td>0.667000</td>
      <td>2.629600e+05</td>
      <td>0.710000</td>
      <td>0.000000</td>
      <td>0.086800</td>
      <td>8.000000</td>
      <td>0.263000</td>
      <td>-7.118000</td>
      <td>1.000000</td>
      <td>48.000000</td>
      <td>0.075400</td>
      <td>135.712000</td>
      <td>0.749000</td>
      <td>1999.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.996000</td>
      <td>0.988000</td>
      <td>5.403500e+06</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>1.000000</td>
      <td>3.855000</td>
      <td>1.000000</td>
      <td>100.000000</td>
      <td>0.969000</td>
      <td>244.091000</td>
      <td>1.000000</td>
      <td>2020.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c7c4ad01-4ed3-429a-a3c7-6ce90fe5c925')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c7c4ad01-4ed3-429a-a3c7-6ce90fe5c925 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c7c4ad01-4ed3-429a-a3c7-6ce90fe5c925');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e97283a8-2c41-42cd-baaf-6d57fcb7c4ca">
  <button class="colab-df-quickchart" onclick="quickchart('df-e97283a8-2c41-42cd-baaf-6d57fcb7c4ca')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e97283a8-2c41-42cd-baaf-6d57fcb7c4ca button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="aQe_r3sJ9o6H">
<p>Exploding the artists to a list and changing from miliseconds to
minutes for better readability</p>
</div>
<div class="cell code" data-execution_count="14" id="QiOYIDuJW7Lp">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_artists(artists):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> artists <span class="kw">and</span> artists.startswith(<span class="st">&#39;[&#39;</span>) <span class="kw">and</span> artists.endswith(<span class="st">&#39;]&#39;</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        artists_list <span class="op">=</span> re.findall(<span class="vs">r&quot;&#39;([^&#39;]*)&#39;&quot;</span>, artists)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;, &#39;</span>.join(artists_list)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> artists</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;artists&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;artists&#39;</span>].<span class="bu">apply</span>(format_artists)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15" id="oT0SFPIoW8RV">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;duration_min&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;duration_ms&#39;</span>] <span class="op">/</span> <span class="dv">60000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;release_date&#39;</span>, <span class="st">&#39;duration_ms&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15" id="Y40gvkBTX9yH">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="general-data-exploration" class="cell markdown"
id="ZJygzS3LX7et">
<h1>General Data Exploration</h1>
</section>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:790}"
id="VvB7FFKUZKfy" data-outputId="6b427c2e-a66d-4677-92d3-9d9693e9dd05">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tracks <span class="op">=</span> df</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>new_format <span class="op">=</span> {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;id&#39;</span>: <span class="st">&#39;object&#39;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;name&#39;</span>: <span class="st">&#39;object&#39;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;popularity&#39;</span>: <span class="st">&#39;int64&#39;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;explicit&#39;</span>: <span class="st">&#39;int64&#39;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;artists&#39;</span>: <span class="st">&#39;object&#39;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;year&#39;</span>: <span class="st">&#39;int64&#39;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;danceability&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;energy&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;key&#39;</span>: <span class="st">&#39;int64&#39;</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;loudness&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;mode&#39;</span>: <span class="st">&#39;int64&#39;</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;speechiness&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;acousticness&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;instrumentalness&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;liveness&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;valence&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;tempo&#39;</span>: <span class="st">&#39;float64&#39;</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>tracks.reindex(columns<span class="op">=</span>new_format.keys())</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-58208ccb-81da-4075-9b17-2b7cabafde27" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>popularity</th>
      <th>explicit</th>
      <th>artists</th>
      <th>year</th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6KbQ3uYMLKb5jDxLF7wYDD</td>
      <td>Singende Bataillone 1. Teil</td>
      <td>0</td>
      <td>0</td>
      <td>Carl Woitschach</td>
      <td>1928</td>
      <td>0.708</td>
      <td>0.1950</td>
      <td>10</td>
      <td>-12.428</td>
      <td>1</td>
      <td>0.0506</td>
      <td>0.9950</td>
      <td>0.563000</td>
      <td>0.1510</td>
      <td>0.7790</td>
      <td>118.469</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6KuQTIu1KoTTkLXKrwlLPV</td>
      <td>Fantasiestücke, Op. 111: Più tosto lento</td>
      <td>0</td>
      <td>0</td>
      <td>Robert Schumann, Vladimir Horowitz</td>
      <td>1928</td>
      <td>0.379</td>
      <td>0.0135</td>
      <td>8</td>
      <td>-28.454</td>
      <td>1</td>
      <td>0.0462</td>
      <td>0.9940</td>
      <td>0.901000</td>
      <td>0.0763</td>
      <td>0.0767</td>
      <td>83.972</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6L63VW0PibdM1HDSBoqnoM</td>
      <td>Chapter 1.18 - Zamek kaniowski</td>
      <td>0</td>
      <td>0</td>
      <td>Seweryn Goszczyński</td>
      <td>1928</td>
      <td>0.749</td>
      <td>0.2200</td>
      <td>5</td>
      <td>-19.924</td>
      <td>0</td>
      <td>0.9290</td>
      <td>0.6040</td>
      <td>0.000000</td>
      <td>0.1190</td>
      <td>0.8800</td>
      <td>107.177</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6M94FkXd15sOAOQYRnWPN8</td>
      <td>Bebamos Juntos - Instrumental (Remasterizado)</td>
      <td>0</td>
      <td>0</td>
      <td>Francisco Canaro</td>
      <td>1928</td>
      <td>0.781</td>
      <td>0.1300</td>
      <td>1</td>
      <td>-14.734</td>
      <td>0</td>
      <td>0.0926</td>
      <td>0.9950</td>
      <td>0.887000</td>
      <td>0.1110</td>
      <td>0.7200</td>
      <td>108.003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6N6tiFZ9vLTSOIxkj8qKrd</td>
      <td>Polonaise-Fantaisie in A-Flat Major, Op. 61</td>
      <td>1</td>
      <td>0</td>
      <td>Frédéric Chopin, Vladimir Horowitz</td>
      <td>1928</td>
      <td>0.210</td>
      <td>0.2040</td>
      <td>11</td>
      <td>-16.829</td>
      <td>1</td>
      <td>0.0424</td>
      <td>0.9900</td>
      <td>0.908000</td>
      <td>0.0980</td>
      <td>0.0693</td>
      <td>62.149</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>169904</th>
      <td>4KppkflX7I3vJQk7urOJaS</td>
      <td>Skechers (feat. Tyga) - Remix</td>
      <td>75</td>
      <td>1</td>
      <td>DripReport, Tyga</td>
      <td>2020</td>
      <td>0.875</td>
      <td>0.4430</td>
      <td>1</td>
      <td>-7.461</td>
      <td>1</td>
      <td>0.1430</td>
      <td>0.1730</td>
      <td>0.000032</td>
      <td>0.0891</td>
      <td>0.3060</td>
      <td>100.012</td>
    </tr>
    <tr>
      <th>169905</th>
      <td>1ehhGlTvjtHo2e4xJFB0SZ</td>
      <td>Sweeter (feat. Terrace Martin)</td>
      <td>64</td>
      <td>0</td>
      <td>Leon Bridges, Terrace Martin</td>
      <td>2020</td>
      <td>0.719</td>
      <td>0.3850</td>
      <td>8</td>
      <td>-10.907</td>
      <td>1</td>
      <td>0.0403</td>
      <td>0.0167</td>
      <td>0.031300</td>
      <td>0.1110</td>
      <td>0.2700</td>
      <td>128.000</td>
    </tr>
    <tr>
      <th>169906</th>
      <td>52eycxprLhK3lPcRLbQiVk</td>
      <td>How Would I Know</td>
      <td>70</td>
      <td>0</td>
      <td>Kygo, Oh Wonder</td>
      <td>2020</td>
      <td>0.514</td>
      <td>0.5390</td>
      <td>7</td>
      <td>-9.332</td>
      <td>1</td>
      <td>0.1050</td>
      <td>0.5380</td>
      <td>0.002330</td>
      <td>0.1080</td>
      <td>0.1530</td>
      <td>123.700</td>
    </tr>
    <tr>
      <th>169907</th>
      <td>3wYOGJYD31sLRmBgCvWxa4</td>
      <td>I Found You</td>
      <td>70</td>
      <td>0</td>
      <td>Cash Cash, Andy Grammer</td>
      <td>2020</td>
      <td>0.646</td>
      <td>0.7610</td>
      <td>1</td>
      <td>-2.557</td>
      <td>1</td>
      <td>0.0385</td>
      <td>0.0714</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.4720</td>
      <td>129.916</td>
    </tr>
    <tr>
      <th>169908</th>
      <td>60RFlt48hm0l4Fu0JoccOl</td>
      <td>More Hearts Than Mine</td>
      <td>65</td>
      <td>0</td>
      <td>Ingrid Andress</td>
      <td>2020</td>
      <td>0.512</td>
      <td>0.4280</td>
      <td>0</td>
      <td>-7.387</td>
      <td>1</td>
      <td>0.0271</td>
      <td>0.1090</td>
      <td>0.000000</td>
      <td>0.1050</td>
      <td>0.3660</td>
      <td>80.588</td>
    </tr>
  </tbody>
</table>
<p>169909 rows × 17 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-58208ccb-81da-4075-9b17-2b7cabafde27')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-58208ccb-81da-4075-9b17-2b7cabafde27 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-58208ccb-81da-4075-9b17-2b7cabafde27');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8266b053-a1fe-4649-b637-57c1fc1b613d">
  <button class="colab-df-quickchart" onclick="quickchart('df-8266b053-a1fe-4649-b637-57c1fc1b613d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8266b053-a1fe-4649-b637-57c1fc1b613d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:997}"
id="Onvl-Cr4qOFD" data-outputId="fe96286b-290e-45b2-a1ed-07fc0946a31d">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>yearly_counts <span class="op">=</span> tracks[<span class="st">&#39;year&#39;</span>].value_counts().sort_index()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>tracks[<span class="st">&#39;decade&#39;</span>] <span class="op">=</span> (tracks[<span class="st">&#39;year&#39;</span>] <span class="op">//</span> <span class="dv">10</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>decade_counts <span class="op">=</span> tracks[<span class="st">&#39;decade&#39;</span>].value_counts().sort_index()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.plot(yearly_counts.index, yearly_counts.values, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Frequency of Tracks by Year&#39;</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>plt.bar(decade_counts.index, decade_counts.values, color<span class="op">=</span><span class="st">&#39;lightgreen&#39;</span>, width<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Frequency of Tracks by Decade&#39;</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Decade&#39;</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/cb2244c9370ea1c6647d8ad29671995f7956521a.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/1b10d0bb21789da0bba327784f0659915fc2de07.png" /></p>
</div>
</div>
<div class="cell markdown" id="7QCZ3nLV93vd">
<p>The data set we drew from is more heavily based on more recent
music</p>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="nObU1Wg6nuno" data-outputId="7902768e-57b5-4357-ba73-e60480357d31">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>feature_columns <span class="op">=</span> [<span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;valence&#39;</span>, <span class="st">&#39;liveness&#39;</span>, <span class="st">&#39;speechiness&#39;</span>, <span class="st">&#39;acousticness&#39;</span>, <span class="st">&#39;instrumentalness&#39;</span>, <span class="st">&#39;duration_min&#39;</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>yearly_stats <span class="op">=</span> tracks.groupby(<span class="st">&#39;year&#39;</span>)[feature_columns].agg([<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;median&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>])</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>yearly_stats.columns <span class="op">=</span> [<span class="st">&#39;_&#39;</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> yearly_stats.columns.values]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_feature_stats(feature, stats_df):</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    stats_df[[<span class="ss">f&quot;</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">_mean&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">_median&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">_std&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">_max&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">_min&quot;</span>]].plot(ax<span class="op">=</span>plt.gca())</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Statistical Measures for </span><span class="sc">{</span>feature<span class="sc">.</span>capitalize()<span class="sc">}</span><span class="ss"> Over Years&#39;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="ss">f&#39;</span><span class="sc">{</span>feature<span class="sc">.</span>capitalize()<span class="sc">}</span><span class="ss"> Value&#39;</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each feature</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> feature_columns:</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    plot_feature_stats(feature, yearly_stats)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/742ea243cee8e07d34c6028c2f17c8482b4e48b6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/e05f6338ad970eeddfffaeff47c3819257b3c0ea.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/dc445969cdcc461b30ecbe27f7a5c3770b35480e.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/a8195a9fa2382e0fa432eec099021f0c394fd972.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/03b5baf77e15bd4324ccc83a0debe03e1bd87ebc.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/59cea7dc9212b39fa151a465fbb8925783b0cd19.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/2d53e95bdbf7121ab18fc6fe28bda99d976d0503.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/21ed6473c425c85aa5c9bee94ffbe25cb40752c2.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/2cf76bd2159a78d2a7238b8979797e03d58bbbba.png" /></p>
</div>
</div>
<div class="cell markdown" id="_0s5GLZx-b8R">
<p>Tempo has slightly increased over the years however energy has
increased by a significantly larger magnitude. The other features mostly
stayed the same but one interesting finding is that the standard
deviation for instrumentalness and especially speechiness decreased over
the years meaning that in these 2 forms music became more
normalized.</p>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="Mtekm-5kSUPS" data-outputId="e704d8da-1d77-4b8d-86f0-0fb2cd738246">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>tracks, x<span class="op">=</span><span class="st">&#39;key&#39;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of keys&#39;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/bfcbd5ccdaf8582ee0f404eea86130ebaa59522f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:427}"
id="8-tw9WLESamp" data-outputId="4de51616-c696-4262-cc3c-b61ec34d2f12">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>percentage_major <span class="op">=</span> <span class="bu">len</span>(tracks[tracks[<span class="st">&#39;mode&#39;</span>] <span class="op">==</span> <span class="dv">1</span>])<span class="op">/</span> tracks.shape[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>percentage_minor <span class="op">=</span> <span class="bu">len</span>(tracks[tracks[<span class="st">&#39;mode&#39;</span>] <span class="op">==</span> <span class="dv">0</span>])<span class="op">/</span> tracks.shape[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>tracks, x<span class="op">=</span><span class="st">&#39;mode&#39;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Modes of tracks&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Ratio of modes: </span><span class="sc">{:.2f}</span><span class="st"> </span><span class="sc">% o</span><span class="st">f songs are in Major, </span><span class="sc">{:.2f}</span><span class="st"> </span><span class="sc">% i</span><span class="st">n Minor&#39;</span>.<span class="bu">format</span>(percentage_major, percentage_minor))</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/25379ac110e5e7b5bcf41d7ae16b01f19e239bde.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Ratio of modes: 70.86 % of songs are in Major, 29.14 % in Minor
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="4NCDWjSJSeJr" data-outputId="46f92528-3ae3-4622-9d0e-1de17ab8a21e">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>audio_ft <span class="op">=</span> [<span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;energy&#39;</span>, <span class="st">&#39;speechiness&#39;</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;acousticness&#39;</span>, <span class="st">&#39;instrumentalness&#39;</span>, <span class="st">&#39;liveness&#39;</span>, <span class="st">&#39;valence&#39;</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplots for audio features, features with range [0, 1] can be shown in one figure</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tracks.loc[:, audio_ft], palette<span class="op">=</span><span class="st">&#39;Blues_r&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Boxplot for audio features with range between 0 and 1&#39;</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>f, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tracks.loc[:, <span class="st">&#39;loudness&#39;</span>], palette<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Boxplot for loudness&#39;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tracks.loc[:, <span class="st">&#39;tempo&#39;</span>], palette<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&#39;Boxplot for tempo&#39;</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/4b68ef0733e40cc91513578fabbf129dc1f0abc1.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/01a31909434c07aab548e5b86bccc665dfd927da.png" /></p>
</div>
</div>
<div class="cell markdown" id="rHDTnxGv_7F5">
<p>Acousticness has the largest range between the bottom and top edge of
the box. Instrumentalness but also speechiness have a really low .75
percentile and a higher number of outliers. That means that their are
similar for most of the tracks, so they might not be so important as
features for the model. For loudness and tempo, they mostly are
distributed in a certain small range with a number of outliers.</p>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:805}"
id="AhjXoUmdamBV" data-outputId="04eec68c-56d4-4b59-824e-95f6e3a0f462">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>feature_columns <span class="op">=</span> [<span class="st">&#39;popularity&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;valence&#39;</span>, <span class="st">&#39;liveness&#39;</span>, <span class="st">&#39;speechiness&#39;</span>, <span class="st">&#39;acousticness&#39;</span>, <span class="st">&#39;instrumentalness&#39;</span>, <span class="st">&#39;duration_min&#39;</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df_selected <span class="op">=</span> tracks[feature_columns]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df_selected.corr(method<span class="op">=</span><span class="st">&#39;pearson&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Heatmap of Track Characteristics and Popularity&#39;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/069e4f3619b063041add52f15c8e15cb84a8fae1.png" /></p>
</div>
</div>
<div class="cell markdown" id="g0dQpsxPAHj1">
<p>Acousticness and energy are highly correlated with popularity of a
song. The danceability also plays a factor although not as big.</p>
<p>high positive correlation: energy - loudness, valence -
danceability</p>
<p>high negative correlation: acousticness - energy, acousticness -
loudness</p>
<p>The correlations imply some linear relations between some audio
features, so I will remove energy from my features for the model.</p>
</div>
<div class="cell markdown" id="NaOSz2WkEsww">
<p><strong>Feature Engineering</strong></p>
<p>Feature engineering is critical for optimizing our dataset for the
learning models we plan on using (classification, regression, and
clustering).</p>
<ul>
<li>Converting duration to seconds standardizes the time</li>
<li>Categorizing tempo into buckets simplifies the analysis for
classification models by grouping</li>
<li>Normalizing loudness prevents features with different scales from
skewing the data</li>
<li>New combined terms like energy_danceability allow the models to
learn from combined effects</li>
<li>Calculating the mean and standard deviation of audio features
provides a summary that helps models understand overall trends and
variability</li>
</ul>
<p>These features seek to improve the dataset, ensuring our models are
well-equipped to derive meaningful and accurate predictions.</p>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="5dbPuB1eFCK5" data-outputId="8479c68f-6623-4d2e-d650-306d5c705587">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of the dataframe (feature engineering for EDA and classification)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_feature_engineering <span class="op">=</span> df.copy()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Engineering</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tempo Categories</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>df_feature_engineering[<span class="st">&#39;tempo_bin&#39;</span>] <span class="op">=</span> pd.cut(df_feature_engineering[<span class="st">&#39;tempo&#39;</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">240</span>], labels<span class="op">=</span>[<span class="st">&#39;Slow&#39;</span>, <span class="st">&#39;Moderate&#39;</span>, <span class="st">&#39;Fast&#39;</span>, <span class="st">&#39;Very Fast&#39;</span>])</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loudness normalization (z-score normalization)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>df_feature_engineering[<span class="st">&#39;loudness_normalized&#39;</span>] <span class="op">=</span> scaler.fit_transform(df_feature_engineering[[<span class="st">&#39;loudness&#39;</span>]])</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Energy-Danceability</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>df_feature_engineering[<span class="st">&#39;energy_danceability&#39;</span>] <span class="op">=</span> df_feature_engineering[<span class="st">&#39;energy&#39;</span>] <span class="op">*</span> df_feature_engineering[<span class="st">&#39;danceability&#39;</span>]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>df_feature_engineering <span class="op">=</span> df_feature_engineering.dropna()</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean and standard deviation of selected audio features</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>audio_features <span class="op">=</span> [<span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;energy&#39;</span>, <span class="st">&#39;speechiness&#39;</span>, <span class="st">&#39;valence&#39;</span>, <span class="st">&#39;acousticness&#39;</span>, <span class="st">&#39;instrumentalness&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;liveness&#39;</span>]</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>df_feature_engineering[<span class="st">&#39;mean_audio_features&#39;</span>] <span class="op">=</span> df_feature_engineering[audio_features].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>df_feature_engineering[<span class="st">&#39;std_audio_features&#39;</span>] <span class="op">=</span> df_feature_engineering[audio_features].std(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>df_feature_engineering <span class="op">=</span> pd.get_dummies(df_feature_engineering, columns<span class="op">=</span>[<span class="st">&#39;tempo_bin&#39;</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicate columns if any</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>df_feature_engineering <span class="op">=</span> df_feature_engineering.loc[:, <span class="op">~</span>df_feature_engineering.columns.duplicated()]</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># List of numeric features</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>numeric_features <span class="op">=</span> [<span class="st">&#39;loudness_normalized&#39;</span>, <span class="st">&#39;energy_danceability&#39;</span>, <span class="st">&#39;mean_audio_features&#39;</span>, <span class="st">&#39;std_audio_features&#39;</span>]</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histograms for numeric features</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> numeric_features:</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    sns.histplot(df_feature_engineering[feature], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Distribution of </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(feature)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot boxplots for numeric features</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> numeric_features:</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(y<span class="op">=</span>df_feature_engineering[feature])</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Boxplot of </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(feature)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Select features for pairplot</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>selected_features_for_pairplot <span class="op">=</span> [<span class="st">&#39;loudness_normalized&#39;</span>, <span class="st">&#39;energy_danceability&#39;</span>, <span class="st">&#39;mean_audio_features&#39;</span>, <span class="st">&#39;std_audio_features&#39;</span>, <span class="st">&#39;explicit&#39;</span>]</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/d68e672e34e1f4119bd5abe3e0d7fe8fbaa5f690.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/d441728b43c0feebdf9bbf7902282bf5ff29df9c.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/84b8f9155029535ae6f9f79b4142892f1b949b6e.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/108535e2737d5142420a49d8bd70b4208ba6d3d5.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/e63c501ab94eccc747d3572ee4101016b67105b8.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/3bbd0ab9000e0fcb6ca10aa72208a20512dcfb35.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/6fe2a26b941008906db7e44dc43409009f1452b8.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/04bfca84dc0ea9a7bedbcec8de9fc6ac33b4a6dc.png" /></p>
</div>
</div>
<section id="explicit-song-classification" class="cell markdown"
id="yy7y7agyyoWm">
<h1>Explicit Song Classification</h1>
</section>
<div class="cell markdown" id="34ipMpjDCxfl">
<p>Random Forest Classification - In this section lets first employ a
Random Forest model to predict whether a song is explicit based on
various audio features.</p>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="CVbUl44HFn5d" data-outputId="a55b3322-ba53-4b02-c26d-e956a0e20bf2">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_classification <span class="op">=</span> df_feature_engineering.copy()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop categoricals</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [<span class="st">&#39;artists&#39;</span>, <span class="st">&#39;id&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;release_date&#39;</span>, <span class="st">&#39;tempo_category&#39;</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>df_classification <span class="op">=</span> df_classification.drop(columns<span class="op">=</span>[col <span class="cf">for</span> col <span class="kw">in</span> columns_to_drop <span class="cf">if</span> col <span class="kw">in</span> df_classification.columns])</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_classification.drop(columns<span class="op">=</span>[<span class="st">&#39;explicit&#39;</span>])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_classification[<span class="st">&#39;explicit&#39;</span>]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce the size of the dataset for feature selection</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>X_sample, _, y_sample, _ <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.95</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>rf_classifier <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>rf_classifier.fit(X_sample, y_sample)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get feature importances</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> rf_classifier.feature_importances_</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.argsort(importances)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Select top n features</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> X.columns[indices[:n_features]]</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Selected Features:&quot;</span>, selected_features)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Selected Features: Index([&#39;speechiness&#39;, &#39;year&#39;, &#39;danceability&#39;, &#39;acousticness&#39;,
       &#39;energy_danceability&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell markdown" id="nq1aS3iqF8pX">
<p>First we remove non-numeric columns and encode categorical variables
to ensure all features are numeric and suitable for machine learning
models.</p>
<p>Then we uses a RandomForestClassifier on a sample of the data to
identify the top five most important features which are most likely to
have the greatest predictive power for the explicit classification
task.</p>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="wduE_riHF9r8" data-outputId="5aa21dff-0da3-424e-bd65-cad60224a2af">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets with selected features</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>X_train_selected, X_test_selected, y_train, y_test <span class="op">=</span> train_test_split(X[selected_features], y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Forest model with selected features</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>rf_classifier.fit(X_train_selected, y_train)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf_classifier.predict(X_test_selected)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the Random Forest model</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>rf_accuracy <span class="op">=</span> accuracy_score(y_test, y_pred_rf)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Classification Report:&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_rf))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Accuracy with Selected Features:&quot;</span>, rf_accuracy)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix for Random Forest</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>rf_cm <span class="op">=</span> confusion_matrix(y_test, y_pred_rf)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>sns.heatmap(rf_cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, xticklabels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>], yticklabels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Random Forest Confusion Matrix with Selected Features&#39;</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted Explicit Status&#39;</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual Explicit Status&#39;</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature Importance from Random Forest</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Feature&#39;</span>: selected_features, <span class="st">&#39;Importance&#39;</span>: importances[indices[:n_features]]})</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> feature_importance_df.sort_values(by<span class="op">=</span><span class="st">&#39;Importance&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Importance&#39;</span>, y<span class="op">=</span><span class="st">&#39;Feature&#39;</span>, data<span class="op">=</span>feature_importance_df)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Feature Importance from Random Forest with Selected Features&#39;</span>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Feature&#39;</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Random Forest Classification Report:
              precision    recall  f1-score   support

           0       0.96      0.98      0.97     31062
           1       0.77      0.57      0.66      2890

    accuracy                           0.95     33952
   macro avg       0.87      0.78      0.81     33952
weighted avg       0.94      0.95      0.95     33952

Random Forest Accuracy with Selected Features: 0.9489868049010367
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/079afd30c17a4fb57deac14f2e046d238dc169a6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/ed1d4dce3c35ad9e3d24bfd12c9d96a6f3163d2f.png" /></p>
</div>
</div>
<div class="cell markdown" id="fyO5MKKvF_yv">
<p>Our results from the Random Forest model for predicting explicit
content in songs demonstrate a high level of accuracy. The model
achieved an overall accuracy of ~ 94.9% with a high precision of 96% for
non-explicit songs, and 77% for explicit songs.</p>
<p>The recall rates were 98% for non-explicit songs and 57% for explicit
songs. In other words the model is very good at correctly identifying
non-explicit songs but it has limitations in identifying explicit
ones.</p>
<p>The confusion matrix highlights this displaying how the model
correctly identified 30,575 non-explicit songs and 1,645 explicit songs
but misclassified 1,245 explicit songs as non-explicit (Type II error)
and 487 non-explicit songs as explicit (Type I error).</p>
<p>Finally the feature importance analysis found that "speechiness" is
the most important feature for predicting explicit content followed by
the "year" of release then "danceability" and then "acousticness" and
finally "energy_danceability."</p>
<p>This suggests that songs with higher speechiness are more likely to
be explicit which makes sense as explicit content often involves spoken
words.</p>
<p>Additionally the release year being a significant feature reflects
trends in explicit content over time becoming more acceptable.</p>
<p>The model's ability to identify key features and its high accuracy
make it a useful tool for predicting explicit content in songs but there
is still room for improvement.</p>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ad4NaiBeGEPU" data-outputId="a59309a3-13ef-4461-b8b7-5a1407d33569">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation on the Random Forest model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>rf_cv_scores <span class="op">=</span> cross_val_score(rf_classifier, X[selected_features], y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Random Forest Cross-Validation Scores: </span><span class="sc">{</span>rf_cv_scores<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Random Forest Mean Cross-Validation Score: </span><span class="sc">{</span>rf_cv_scores<span class="sc">.</span>mean()<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Random Forest Cross-Validation Scores: [0.94863336 0.94645382 0.9458353  0.95526037 0.94842567]
Random Forest Mean Cross-Validation Score: 0.9489217037327539
</code></pre>
</div>
</div>
<div class="cell markdown" id="CoM-CtALGYHK">
<p>The Random Forest model achieved cross-validation scores ranging from
approximately 94.6% to 95.5%, indicating consistent performance across
different subsets of the data. The mean cross-validation score of 94.9%
demonstrates the model's reliability in predicting explicit content in
songs.</p>
</div>
<div class="cell markdown" id="RMU43WlAGSj8">
<hr />
<p>Let's try with SVM classification to see what results it derives.
Let's run SVM and compare its performance with the Random Forest model
in terms of accuracy and misclassifications.</p>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:832}"
id="rRk7jZvxGWdR" data-outputId="5dbb18cb-6bd6-437e-a1a6-173a690e9415">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the SVM model with selected features</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>svm_classifier <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">&#39;linear&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>svm_classifier.fit(X_train_selected, y_train)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y_pred_svm <span class="op">=</span> svm_classifier.predict(X_test_selected)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the SVM model</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>svm_accuracy <span class="op">=</span> accuracy_score(y_test, y_pred_svm)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;SVM Classification Report:&quot;</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_svm))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;SVM Accuracy with Selected Features:&quot;</span>, svm_accuracy)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion Matrix for SVM</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>svm_cm <span class="op">=</span> confusion_matrix(y_test, y_pred_svm)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>sns.heatmap(svm_cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Reds&#39;</span>, xticklabels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>], yticklabels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;SVM Confusion Matrix with Selected Features&#39;</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted Explicit Status&#39;</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual Explicit Status&#39;</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>SVM Classification Report:
              precision    recall  f1-score   support

           0       0.92      0.99      0.96     31062
           1       0.57      0.11      0.19      2890

    accuracy                           0.92     33952
   macro avg       0.74      0.55      0.57     33952
weighted avg       0.89      0.92      0.89     33952

SVM Accuracy with Selected Features: 0.9170593779453345
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/00673f090ac1010b4a354c2b15b5f79beca086cc.png" /></p>
</div>
</div>
<div class="cell markdown" id="dOy75BOwGezE">
<p>Our results from the SVM model for predicting explicit content in
songs demonstrate a good level of accuracy. The model achieved an
overall accuracy of ~91.7% with a high precision of 92% for non-explicit
songs, and 57% for explicit songs.</p>
<p>The recall rates were 99% for non-explicit songs and 11% for explicit
songs. In other words the model is very good at correctly identifying
non-explicit songs but it has significant limitations in identifying
explicit ones.</p>
<p>The confusion matrix highlights this, displaying how the model
correctly identified 30,815 non-explicit songs and 321 explicit songs
but misclassified 2,569 explicit songs as non-explicit (Type II error)
and 247 non-explicit songs as explicit (Type I error).</p>
<p>Comparing the two models the Random Forest model outperforms the SVM
model in terms of overall accuracy, precision, and recall for explicit
songs.</p>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="HkG0idW1GieP" data-outputId="5e1e0fd6-3356-4a31-addb-c93a3a5b42fc">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the most important feature</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    sns.histplot(df[selected_features[i]], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Distribution of </span><span class="sc">{</span>selected_features[i]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(selected_features[i])</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/224050f384e083542b861c33319ce05f70e4fb4f.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/dccfe3307acb57fd33c2006c843d8fa54f58bd16.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/010c96f0dee34a89739b8fb231d7915f22a80ef0.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/8cf7be8dd6cb6f43caf0ec445350e8fe0f38e3c6.png" /></p>
</div>
</div>
<div class="cell markdown" id="h2EoGygpGlSE">
<p>Speechiness: The distribution of "speechiness" is heavily skewed
towards lower values with a sharp peak near 0. This indicates that most
songs have low speechiness, meaning they contain fewer spoken words.
However there is a small number of songs with high speechiness values
which are likely to be spoken word content or rap songs contributing to
their classification as explicit.</p>
<p>Year: The distribution of "year" shows a relatively even spread
across several decades, with a noticeable increase in the number of
songs from the 1950s onwards. This reflects the growth of the music
industry over time. The decline towards the most recent years might be
due to incomplete data for the latest releases. This feature indicates
that explicit content trends have evolved over time, which helps in
understanding historical changes in music.</p>
<p>Danceability: The distribution of "danceability" is approximately
normal, centered around moderate values. This suggests that most songs
in the dataset are reasonably danceable, with fewer songs at the
extremes of the danceability spectrum. The even distribution implies
that danceability is a consistent feature across different types of
music, making it a useful predictor for explicit content when combined
with other features.</p>
<p>Acousticness: The distribution of "acousticness" is bimodal, with
peaks at the very low and very high ends. This suggests a clear division
between highly acoustic songs (such as ballads and classical music) and
non-acoustic songs (such as electronic, hip-hop, rock music). The
presence of these distinct groups indicates that acousticness can help
differentiate between different types of songs and their likelihood of
being explicit.</p>
</div>
<div class="cell markdown" id="sR2uewzKGn2t">
<hr />
<p><strong>Conclusion</strong> Our classification analysis using Random
Forest and SVM models demonstrated that "speechiness" is the most
critical feature for predicting explicit content in songs, followed by
"year," "danceability," "acousticness," and "energy_danceability." The
Random Forest model outperformed the SVM model in terms of accuracy,
precision, and recall, particularly for identifying explicit songs.
These findings suggest that explicit content in songs is closely
associated with higher speechiness and evolving trends over time,
providing valuable insights for content moderation and music
recommendation systems.</p>
</div>
<div class="cell markdown" id="3HO6WTa5yxYO">
<p>#Song Popularity Predictor</p>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:699}"
id="TEh3lv6Rglnz" data-outputId="8dd5dccc-e776-4133-98e1-c1edbbc03203">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>feature_columns <span class="op">=</span> [<span class="st">&#39;popularity&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;duration_min&#39;</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df_selected <span class="op">=</span> df[feature_columns]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df_selected.corr(method<span class="op">=</span><span class="st">&#39;pearson&#39;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Heatmap of Track Characteristics and Popularity&#39;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/595e6178dddbd22eed42e525c6c6fe35266e3b99.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="U_xjTrmVgmN2" data-outputId="9ded7c19-340b-4c60-cee9-062c242a4cae">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix[<span class="st">&#39;popularity&#39;</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">
<pre><code>popularity      1.000000
energy          0.497488
danceability    0.221077
tempo           0.135047
duration_min    0.063292
Name: popularity, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="BnxmlcO0gqhX" data-outputId="480950f0-971f-4405-fdc8-2d0faf944247">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for &#39;energy&#39; vs &#39;popularity&#39;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df.dropna(subset<span class="op">=</span>[<span class="st">&#39;energy&#39;</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">&#39;energy&#39;</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;energy&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of Energy vs Popularity&#39;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Energy&#39;</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/564a5209c8d85ff4ab89a82ba223929a638cba1b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="2ShbxXJngqzl" data-outputId="6df085db-c1a6-4f3b-bfa3-fca0c692e244">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for &#39;danceability&#39; vs &#39;popularity&#39;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;danceability&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of Danceability vs Popularity&#39;</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Danceability&#39;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/d665e1908f87d5bb5abfa08f30f40497fe3765cf.png" /></p>
</div>
</div>
<div class="cell markdown" id="arr95h63gw0N">
<p>Not removing outliers as songs can be not danceable but they can be
songs</p>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="EPQcuJFNgrGU" data-outputId="e2cf4f85-da1d-436c-b3ef-b0df32a87735">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for &#39;tempo&#39; vs &#39;popularity&#39;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;tempo&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of Tempo vs Popularity&#39;</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Tempo&#39;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/eb1df225070150319151fa647058c856531945af.png" /></p>
</div>
</div>
<div class="cell markdown" id="k5ew9W5Yg1Mb">
<p>removing outliers are without tempo it is not really a song</p>
</div>
<div class="cell code" data-execution_count="39" id="9dVw00b5grXP">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering data to remove rows where &#39;tempo&#39; is 0</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>filtered_tempo <span class="op">=</span> df[df[<span class="st">&#39;tempo&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="b7GXq6JXgsL7" data-outputId="2aa2feb7-e012-439c-84ce-fdc353decba5">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for filtered data &#39;tempo&#39; vs &#39;popularity&#39;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;tempo&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>filtered_tempo)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of Tempo vs Popularity (Filtered)&#39;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Tempo&#39;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/73388dd6fe74974752abea7167e8adb4c2f4ca5a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="Di7IATTmgsYn" data-outputId="a5a3c885-a78e-4594-aaca-d8d91f7265ff">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for &#39;duration_min&#39; vs &#39;popularity&#39;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;duration_min&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of Duration (min) vs Popularity&#39;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Duration (min)&#39;</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/1dec6b545f69436c7881e7c939e194e0daeaca36.png" /></p>
</div>
</div>
<div class="cell markdown" id="UZxoiXlKg7De">
<p>Songs are no more than 3-4 min long so thats why removing the
outliers</p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="u9tEhFubg6wt" data-outputId="8e9834be-8869-4c20-bc31-f01e446c5da5">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box-and-Whisker Plot to Identify Outliers in &#39;duration_min&#39;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span>df[<span class="st">&#39;duration_min&#39;</span>])</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Box-and-Whisker Plot of Duration (min)&#39;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Duration (min)&#39;</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/eddfdf385cc9f575e0cd1bc8962eb8bd618f4779.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="5ztdu7Jdg9Ci" data-outputId="553ddf8f-8e98-4c44-f4b8-52e71ff9319c">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding and printing the outliers</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Q1 <span class="op">=</span> df[<span class="st">&#39;duration_min&#39;</span>].quantile(<span class="fl">0.25</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Q3 <span class="op">=</span> df[<span class="st">&#39;duration_min&#39;</span>].quantile(<span class="fl">0.75</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Q1)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Q3)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(IQR)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>2.8507
4.382883333333333
1.5321833333333332
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="IHUTBUHhg9PS" data-outputId="124d32f8-14d2-4eef-a16f-6e108a372579">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> df[(df[<span class="st">&#39;duration_min&#39;</span>] <span class="op">&gt;</span> (Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR))]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(outliers)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>filtered_duration <span class="op">=</span> df[df[<span class="st">&#39;duration_min&#39;</span>] <span class="op">&lt;=</span> Q3]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot for filtered data &#39;tempo&#39; vs &#39;popularity&#39;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;duration_min&#39;</span>, y<span class="op">=</span><span class="st">&#39;popularity&#39;</span>, data<span class="op">=</span>filtered_duration)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Scatter Plot of duration_min vs Popularity (Filtered)&#39;</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;duration_min&#39;</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Popularity&#39;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/7316543c0f88cbd486cdd94e26c64351b21eadb3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="GWrluTvbg9au" data-outputId="de42803e-7c94-4546-95de-5f69d0196c02">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Showing the filtered DataFrame</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&quot;Filtered DataFrame:&quot;)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(filtered_df)</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> df[(df[<span class="st">&#39;tempo&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;duration_min&#39;</span>] <span class="op">&lt;=</span> <span class="dv">5</span>)]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>final_df <span class="op">=</span> filtered_df[[<span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;duration_min&#39;</span>, <span class="st">&#39;popularity&#39;</span>]]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>final_df <span class="op">=</span> final_df.drop_duplicates()</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the final DataFrame after dropping duplicates</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(final_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>        energy  danceability    tempo  duration_min  popularity
0       0.1950         0.708  118.469      2.644133           0
1       0.0135         0.379   83.972      4.702217           0
2       0.2200         0.749  107.177      1.738333           0
3       0.1300         0.781  108.003      3.012667           0
6       0.1970         0.444   80.495      2.277117           0
...        ...           ...      ...           ...         ...
169904  0.4430         0.875  100.012      2.730000          75
169905  0.3850         0.719  128.000      2.791133          64
169906  0.5390         0.514  123.700      3.011667          70
169907  0.7610         0.646  129.916      2.788467          70
169908  0.4280         0.512   80.588      3.579783          65

[142688 rows x 5 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:545}"
id="nYMfX96Fg9sL" data-outputId="0a173f5a-21b3-4190-9c93-d1ca6a678a83">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> final_df.corr()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix with Final Data&#39;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/27443ee36c2cf5712ebbd092114a73850dea87eb.png" /></p>
</div>
</div>
<div class="cell markdown" id="pgBcQ79yhFL5">
<p>No correleation change in Energy, Danceability as expected. Even tho
removing 0's from tempo, the correlation doesnt change, while we notice
that as duration of the song was constrained the correlation showed a
positive increase indicating shorter duration songs do show correleation
with how popular a song is</p>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hIC8hTf1g94b" data-outputId="f8ae5c10-e5ea-419b-b040-d91ecb0dde81">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION ONLY USING ENERGY AS IT IS HIGHEST CORRELEATED</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_df[[<span class="st">&#39;energy&#39;</span>]]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_df[<span class="st">&#39;popularity&#39;</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linear regression model</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model evaluation metrics</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;R^2 Score: </span><span class="sc">{</span>r2<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean Squared Error: 360.6237741499662
R^2 Score: 0.2558107318345475
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-YiP_FE0hHHA" data-outputId="24250bda-89a8-420e-b64c-531a818df7f1">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION USING ALL THE HIGHEST CORRELEATED FEATURES</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_df[[<span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;duration_min&#39;</span>]]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_df[<span class="st">&#39;popularity&#39;</span>]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linear regression model</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model evaluation metrics</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;R^2 Score: </span><span class="sc">{</span>r2<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean Squared Error: 333.3650663904433
R^2 Score: 0.31206225830839396
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="6sih4pbthHVI" data-outputId="05606dc0-8379-4150-bb8b-e48507418712">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot of the final model&#39;s predictions vs true values</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot actual vs predicted values</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of actual vs predicted values</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test, y_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="bu">min</span>(y_test), <span class="bu">max</span>(y_test)], [<span class="bu">min</span>(y_test), <span class="bu">max</span>(y_test)], color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Actual Popularity&#39;</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Predicted Popularity&#39;</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Actual vs Predicted Popularity&#39;</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/a5bd4e47137d03f2ec3fdbbab426801afbe731c3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="20MkBVtRhHiI" data-outputId="0ab1e21f-8215-48b7-f751-8a8ff0799220">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION USING REMAINDER FEATURES EXCLUDING HIGHEST CORRLEATED</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [&#39;acousticness&#39;, &#39;instrumentalness&#39;, &#39;valence&#39;, &#39;liveness&#39;, &#39;loudness&#39;, &#39;speechiness&#39;]</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop NaN values and zeros from the relevant features</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">&#39;acousticness&#39;</span>, <span class="st">&#39;instrumentalness&#39;</span>, <span class="st">&#39;valence&#39;</span>, <span class="st">&#39;liveness&#39;</span>, <span class="st">&#39;loudness&#39;</span>, <span class="st">&#39;speechiness&#39;</span>]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>features)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> features:</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df[feature] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the features (X) and the target (y)</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[features]</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;popularity&#39;</span>]</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linear regression model</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model evaluation metrics</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;R^2 Score: </span><span class="sc">{</span>r2<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean Squared Error: 257.27372647059843
R^2 Score: 0.41851134045889227
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="D9qgGpPyhH0Z" data-outputId="160b6a0c-3606-4f2f-bc93-06b3cb8d5ca1">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR REGRESSION USING FILTERED DATA &amp; REST OF THE FEATRUES</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge final_df and df_additional on their index</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> final_df.merge(df[features], left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the features (X) and the target (y)</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>combined_features <span class="op">=</span> [<span class="st">&#39;energy&#39;</span>, <span class="st">&#39;danceability&#39;</span>, <span class="st">&#39;tempo&#39;</span>, <span class="st">&#39;duration_min&#39;</span>] <span class="op">+</span> features</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> merged_df[combined_features]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the correct column name for popularity (check the column names after merging)</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># It might be &#39;popularity&#39; if it wasn&#39;t duplicated during the merge.</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> merged_df[<span class="st">&#39;popularity&#39;</span>]</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the linear regression model</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model evaluation metrics</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;R^2 Score: </span><span class="sc">{</span>r2<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean Squared Error: 248.6730146771482
R^2 Score: 0.45747948027739527
</code></pre>
</div>
</div>
<div class="cell markdown" id="c5tz2jeWhPd2">
<p><strong><em>BEST MODEL</em></strong></p>
<p>LINEAR REGRESSION USING FILTERED DATA &amp; REST OF THE FEATRUES:</p>
<ul>
<li>this was the best model as it had the lowest MSE, and the highest
R^2.</li>
</ul>
</div>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:871}"
id="ZRWS5bJAhIFT" data-outputId="b81887e1-0a73-43f2-c207-93fe80bf7941">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coeffictents graph</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="op">=</span> pd.DataFrame(model.coef_, X.columns, columns<span class="op">=</span>[<span class="st">&#39;Coefficient&#39;</span>])</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Coefficients:&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coefficients)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>model<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the coefficients</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>plt.bar(coefficients.index, coefficients[<span class="st">&#39;Coefficient&#39;</span>])</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Features&#39;</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Coefficient Value&#39;</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Feature Coefficients in Linear Regression Model&#39;</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Coefficients:
                  Coefficient
energy              12.221559
danceability        25.564725
tempo                0.027374
duration_min         1.790895
acousticness       -24.536212
instrumentalness    -6.159224
valence            -22.531511
liveness            -7.878730
loudness            -0.048211
speechiness        -26.928209
Intercept: 30.165292562897562
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/3d2ce198ab2ca6104744895c015c5075971201e3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="53"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="xVzdSAA4hIb-" data-outputId="40e59c45-1a8e-4e51-d6b4-9d6945d8f5a1">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot of the final model&#39;s predictions vs true values</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot actual vs predicted values</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of actual vs predicted values</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test, y_pred, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="bu">min</span>(y_test), <span class="bu">max</span>(y_test)], [<span class="bu">min</span>(y_test), <span class="bu">max</span>(y_test)], color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Actual Popularity&#39;</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Predicted Popularity&#39;</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Actual vs Predicted Popularity&#39;</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/4ef04372810e9340a0a9f96310a77409a1ec4d89.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="54"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="xVoZHNnXhVrX" data-outputId="74276b9b-8898-44e1-c8e2-c980c029b774">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residuals</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="op">=</span> y_test <span class="op">-</span> y_pred</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram of residuals</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>plt.hist(residuals, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">&#39;k&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Residuals&#39;</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Histogram of Residuals&#39;</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/654fb8f6439ae2c02faf95f3619419d71c0d15bc.png" /></p>
</div>
</div>
<div class="cell markdown" id="BuaTNSIxhWXJ">
<p><strong><em>CONCLUSION</em></strong></p>
<p><strong>Summary of Regression Models</strong></p>
<ul>
<li>Model 1: Using Only 'Energy' Feature</li>
</ul>
<p>Mean Squared Error (MSE): High</p>
<p>R² Score: Low (0.255)</p>
<p>Observation: Using only the 'energy' feature explains only a small
portion of the variance in popularity. Performed very poor.</p>
<ul>
<li>Model 2: Using Cleaned Features of ['energy', 'danceability',
'tempo', 'duration_min']</li>
</ul>
<p>Mean Squared Error (MSE): High</p>
<p>R² Score: Slightly higher or similar (0.312)</p>
<p>Observation: Adding only some features that were highly correleated
still did not perform well.</p>
<ul>
<li>Model 3: Using Least Correleated Features</li>
</ul>
<p>Mean Squared Error (MSE): Slightly lower but still High</p>
<p>R² Score: Improved (0.418)</p>
<p>Observation: Including more features improves the model performance
but still leaves a significant portion of variance unexplained. It
performs better than the model that included features with the highest
correlation.</p>
<ul>
<li>Model 4: Using All Available Features ['acousticness',
'instrumentalness', 'valence', 'liveness', 'loudness', 'speechiness',
'energy', 'danceability', 'tempo', 'duration_min']</li>
</ul>
<p>Mean Squared Error (MSE): Lowest</p>
<p>R² Score: Highest (0.457)</p>
<p>Observation: This model performs the best among all the models
considered, showing that more sets of features can better captures the
variance in popularity.</p>
<ul>
<li>Conclusions</li>
</ul>
<p>Feature Importance: Including additional features significantly
improves the model's ability to explain the variance in the target
variable. This suggests that popularity is influenced by a combination
of multiple factors rather than a single feature like energy.</p>
<p>Model Choice: Despite the improvements, the R² scores indicate that a
large portion of the variance in popularity remains unexplained. This
suggests that Linear Regression may not be the best model for this
dataset.</p>
</div>
<div class="cell markdown" id="lQDl-z3QGAzx">
<p>#Audio Feature based Recommendation Engine</p>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="yuGg2APChSxJ" data-outputId="5541fe93-3eda-4f41-b397-3943ca144020">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="55">
<pre><code>Index([&#39;acousticness&#39;, &#39;artists&#39;, &#39;danceability&#39;, &#39;energy&#39;, &#39;explicit&#39;, &#39;id&#39;,
       &#39;instrumentalness&#39;, &#39;key&#39;, &#39;liveness&#39;, &#39;loudness&#39;, &#39;mode&#39;, &#39;name&#39;,
       &#39;popularity&#39;, &#39;speechiness&#39;, &#39;tempo&#39;, &#39;valence&#39;, &#39;year&#39;, &#39;duration_min&#39;,
       &#39;decade&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<section id="model-building" class="cell markdown" id="VYamR2b4sDAT">
<h2>Model Building</h2>
</section>
<div class="cell markdown" id="SJxOHar-Gebq">
<p>Methods: In building k-clustering models its much easier and more
precise to use numerical values rather than categorical because sample
space is discrete while expecting a continuous space. Therefore i have
chosen to only use numerical features for this model training.</p>
</div>
<div class="cell code" data-execution_count="56" id="ADTLReWDZocx">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> tracks</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> temp.drop([<span class="st">&#39;id&#39;</span>, <span class="st">&#39;name&#39;</span>,<span class="st">&#39;explicit&#39;</span>, <span class="st">&#39;artists&#39;</span>, <span class="st">&#39;mode&#39;</span>, <span class="st">&#39;year&#39;</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;key&#39;</span>, <span class="st">&#39;decade&#39;</span>, <span class="st">&#39;duration_min&#39;</span>,<span class="st">&#39;popularity&#39;</span>, <span class="st">&#39;energy&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scaler.fit_transform(X)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="57"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:489}"
id="PnnZwSlliScS" data-outputId="88446dc3-c039-4b43-aa30-54610b32386a">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>sse <span class="op">=</span> {}</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> time.time()</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">30</span>):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, init<span class="op">=</span><span class="st">&#39;k-means++&#39;</span>, max_iter<span class="op">=</span><span class="dv">100</span>).fit(X)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    sse[k] <span class="op">=</span> kmeans.inertia_</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time.time()</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>diff <span class="op">=</span> t1 <span class="op">-</span> t0</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Computation time for elbow curve with 30 iterations: </span><span class="sc">{:.2f}</span><span class="st"> s&#39;</span>.<span class="bu">format</span>(diff))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">list</span>(sse.keys()), <span class="bu">list</span>(sse.values()))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Number of clusters&quot;</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;SSE&quot;</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Elbow Curve&#39;</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Computation time for elbow curve with 30 iterations: 270.33 s
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/81c9a85b04cc5e37060a30ecf870503cdf27d1c1.png" /></p>
</div>
</div>
<div class="cell markdown" id="N_2P-6kVG98p">
<p>Result of the elbow test shows that the optimal k = 9.</p>
</div>
<div class="cell code" data-execution_count="58" id="fVcZC95Rj5De">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    n_clusters<span class="op">=</span><span class="dv">9</span>, init<span class="op">=</span><span class="st">&#39;random&#39;</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    n_init<span class="op">=</span><span class="dv">10</span>, max_iter<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    tol<span class="op">=</span><span class="fl">1e-04</span>, random_state<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.fit_predict(X)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="kWb_1DzmkDAd" data-outputId="1bb95ad4-816b-4d23-82d1-2b87c87cdbbb">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> silhouette_score(X, model.labels_, metric<span class="op">=</span><span class="st">&#39;euclidean&#39;</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Silhouetter Score: </span><span class="sc">%.3f</span><span class="st">&#39;</span> <span class="op">%</span> score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Silhouetter Score: 0.186
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="60"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:830}"
id="RdsAvABkkTgb" data-outputId="681ff5fc-a137-408e-b029-27a1c97df167">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce dimensions of data to 2 with PCA for visualization</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>X_transformed <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>X_red <span class="op">=</span> pd.DataFrame(X_transformed)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>X_red[<span class="st">&#39;label&#39;</span>] <span class="op">=</span> y_pred</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>unique_labels <span class="op">=</span> np.unique(y_pred)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">10</span>))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> unique_labels:</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    plt.scatter(X_red[X_red[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> i].iloc[:, <span class="dv">0</span>], X_red[X_red[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> i].iloc[:, <span class="dv">1</span>], label<span class="op">=</span>i)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/2635000ab9d55b33fc650b6a0b3ec313f2d4e209.png" /></p>
</div>
</div>
<div class="cell markdown" id="rMTSxdI8HIfU">
<p>I am happy with these results because the clusters are easily
recognizable however they are not fully separated and the sse is
relatively high so the model could still use some work.</p>
</div>
<section id="rec-engine" class="cell markdown" id="Tx9r33uir77J">
<h2>Rec Engine</h2>
</section>
<div class="cell markdown" id="nHdmR1BiJeVb">
<p>To recommend songs, we first find the cluster of the given song. We
then select other songs from the same cluster, ensuring they share
similar audio features. If there are more songs in the cluster than the
required number of recommendations, we randomly sample the required
number of songs. The recommended songs are expected to have similar
audio characteristics to the original song due to their proximity in the
feature space.</p>
</div>
<div class="cell code" data-execution_count="61" id="YgpE9MM9n08X">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="st">&#39;cluster&#39;</span>] <span class="op">=</span> y_pred</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recommend_songs(song_id, n_recommendations<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    song_cluster <span class="op">=</span> temp[temp[<span class="st">&#39;id&#39;</span>] <span class="op">==</span> song_id][<span class="st">&#39;cluster&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    cluster_songs <span class="op">=</span> temp[temp[<span class="st">&#39;cluster&#39;</span>] <span class="op">==</span> song_cluster]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    recommendations <span class="op">=</span> cluster_songs[cluster_songs[<span class="st">&#39;id&#39;</span>] <span class="op">!=</span> song_id]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(recommendations) <span class="op">&gt;</span> n_recommendations:</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        recommendations <span class="op">=</span> recommendations.sample(n<span class="op">=</span>n_recommendations)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> recommendations[[<span class="st">&#39;name&#39;</span>, <span class="st">&#39;artists&#39;</span>, <span class="st">&#39;id&#39;</span>]]</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>sample_song_id <span class="op">=</span> df[<span class="st">&#39;id&#39;</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>recommended_songs <span class="op">=</span> recommend_songs(sample_song_id)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="63"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="Jg9NiDJTou4a" data-outputId="b733734c-de8f-4c3f-ed57-16330168133a">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_songs(original_song_id, recommended_songs):</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    original_song_features <span class="op">=</span> df[df[<span class="st">&#39;id&#39;</span>] <span class="op">==</span> original_song_id].drop([<span class="st">&#39;id&#39;</span>, <span class="st">&#39;name&#39;</span>,<span class="st">&#39;explicit&#39;</span>, <span class="st">&#39;artists&#39;</span>, <span class="st">&#39;mode&#39;</span>, <span class="st">&#39;year&#39;</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;key&#39;</span>, <span class="st">&#39;decade&#39;</span>, <span class="st">&#39;duration_min&#39;</span>,<span class="st">&#39;popularity&#39;</span>, <span class="st">&#39;energy&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    comparisons <span class="op">=</span> []</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, song <span class="kw">in</span> recommended_songs.iterrows():</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>        recommended_song_features <span class="op">=</span> df[df[<span class="st">&#39;id&#39;</span>] <span class="op">==</span> song[<span class="st">&#39;id&#39;</span>]].drop([<span class="st">&#39;id&#39;</span>, <span class="st">&#39;name&#39;</span>,<span class="st">&#39;explicit&#39;</span>, <span class="st">&#39;artists&#39;</span>, <span class="st">&#39;mode&#39;</span>, <span class="st">&#39;year&#39;</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;key&#39;</span>, <span class="st">&#39;decade&#39;</span>, <span class="st">&#39;duration_min&#39;</span>,<span class="st">&#39;popularity&#39;</span>, <span class="st">&#39;energy&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>        distance <span class="op">=</span> euclidean_distances(original_song_features, recommended_song_features)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>        comparisons.append((song[<span class="st">&#39;name&#39;</span>], song[<span class="st">&#39;artists&#39;</span>], song[<span class="st">&#39;id&#39;</span>], distance))</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    comparisons.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">3</span>])</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> comparisons</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co">#testing</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>original_song_id <span class="op">=</span> sample_song_id</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>recommended_songs_list <span class="op">=</span> recommend_songs(original_song_id)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>comparisons <span class="op">=</span> compare_songs(original_song_id, recommended_songs_list)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> song <span class="kw">in</span> comparisons:</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Song: </span><span class="sc">{</span>song[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, Artists: </span><span class="sc">{</span>song[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">, Similarity (Euclidean Distance): </span><span class="sc">{</span>song[<span class="dv">3</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_comparisons(original_song_id, comparisons):</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>    pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>    X_transformed <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>    X_red <span class="op">=</span> pd.DataFrame(X_transformed, columns<span class="op">=</span>[<span class="st">&#39;PC1&#39;</span>, <span class="st">&#39;PC2&#39;</span>])</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>    X_red[<span class="st">&#39;id&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;id&#39;</span>]</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>    X_red[<span class="st">&#39;label&#39;</span>] <span class="op">=</span> temp[<span class="st">&#39;cluster&#39;</span>]</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label <span class="kw">in</span> np.unique(y_pred):</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>        plt.scatter(X_red[X_red[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> label][<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>                    X_red[X_red[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> label][<span class="st">&#39;PC2&#39;</span>], label<span class="op">=</span><span class="ss">f&#39;Cluster </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>    original_song_pca <span class="op">=</span> X_red[X_red[<span class="st">&#39;id&#39;</span>] <span class="op">==</span> original_song_id]</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>    plt.scatter(original_song_pca[<span class="st">&#39;PC1&#39;</span>], original_song_pca[<span class="st">&#39;PC2&#39;</span>], color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="st">&#39;Original Song&#39;</span>, s<span class="op">=</span><span class="dv">200</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> song <span class="kw">in</span> comparisons:</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>        song_pca <span class="op">=</span> X_red[X_red[<span class="st">&#39;id&#39;</span>] <span class="op">==</span> song[<span class="dv">2</span>]]</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>        plt.scatter(song_pca[<span class="st">&#39;PC1&#39;</span>], song_pca[<span class="st">&#39;PC2&#39;</span>], label<span class="op">=</span><span class="ss">f&#39;Recommended: </span><span class="sc">{</span>song[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&#39;</span>, s<span class="op">=</span><span class="dv">100</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Principal Component 1&#39;</span>)</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Principal Component 2&#39;</span>)</span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Song Recommendations and Original Song Comparison&#39;</span>)</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>visualize_comparisons(original_song_id, comparisons)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Song: Godsend, Artists: Beat Happening, Similarity (Euclidean Distance): 5.04
Song: Ellinopoyles omorfes, Artists: Roza Eskenazi, Similarity (Euclidean Distance): 5.33
Song: La resa dei conti (Seconda caccia), Artists: Ennio Morricone, Similarity (Euclidean Distance): 12.99
Song: Pulcinella Suite: VIIIb. Finale. Allegro assai, Artists: Igor Stravinsky, Columbia Symphony Orchestra, Similarity (Euclidean Distance): 17.33
Song: Mi Chapalita - Remasterizado, Artists: Francisco Canaro, Carlos Roldán, Similarity (Euclidean Distance): 21.24
Song: The Shade of the Mango Tree, Artists: Luiz Bonfá, Similarity (Euclidean Distance): 26.41
Song: Shiraki Gevondi (Folk Dance), Artists: A. Merangulian, Shirak Roundelays, Similarity (Euclidean Distance): 27.03
Song: Le sacre du printemps: Part 1 &quot;Adoration of the Earth&quot;, Games of the Rival Clans, Artists: Igor Stravinsky, Columbia Symphony Orchestra, Similarity (Euclidean Distance): 32.51
Song: Watkins Production, Artists: Art Pepper, Sonny Redd, Similarity (Euclidean Distance): 36.82
Song: 賣花女, Artists: 水柳仙, Similarity (Euclidean Distance): 56.91
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/90a39383523f0b7738199bbb01a11ca8b96a6518.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="VcLqNEeDn0xf" data-outputId="b89d2a7d-cbea-4e52-e899-225a3788adbb">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_silhouette_scores(X, labels):</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    silhouette_vals <span class="op">=</span> silhouette_samples(X, labels, metric<span class="op">=</span><span class="st">&#39;euclidean&#39;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    y_ticks <span class="op">=</span> []</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    y_lower, y_upper <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, cluster <span class="kw">in</span> <span class="bu">enumerate</span>(np.unique(labels)):</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        cluster_silhouette_vals <span class="op">=</span> silhouette_vals[labels <span class="op">==</span> cluster]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        cluster_silhouette_vals.sort()</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>        y_upper <span class="op">+=</span> <span class="bu">len</span>(cluster_silhouette_vals)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>        plt.barh(<span class="bu">range</span>(y_lower, y_upper), cluster_silhouette_vals, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, height<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        y_ticks.append((y_lower <span class="op">+</span> y_upper) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>        y_lower <span class="op">+=</span> <span class="bu">len</span>(cluster_silhouette_vals)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    plt.axvline(np.mean(silhouette_vals), color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    plt.yticks(y_ticks, np.unique(labels))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Cluster&#39;</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Silhouette coefficient&#39;</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Silhouette scores for each sample&#39;</span>)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(X, y_pred)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_recommendation_quality(comparisons):</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    songs, distances <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>[(song[<span class="dv">0</span>], song[<span class="dv">3</span>]) <span class="cf">for</span> song <span class="kw">in</span> comparisons])</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>songs, y<span class="op">=</span>distances)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Recommended Songs&#39;</span>)</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Euclidean Distance&#39;</span>)</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Euclidean Distance between Original Song and Recommended Songs&#39;</span>)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>plot_recommendation_quality(comparisons)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/1316b61a580b5f084f677054160f88f2137e350c.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_6b35978a5d2a4b3b90610431c03613af/16f1d3009702d00ed8d58fffe71bd25ae1b6daa2.png" /></p>
</div>
</div>
<section id="clustering-conclusion" class="cell markdown"
id="NpSYiJ2JuxaL">
<h2>Clustering Conclusion:</h2>
<p><strong>Feature Extraction:</strong> Selecting relevant audio
features for similarity calculations.</p>
<p><strong>Normalization:</strong> Ensuring all features contribute
equally to the distance metrics.</p>
<p><strong>Clustering:</strong> Using KMeans to group similar songs
together.</p>
<p><strong>Dimensionality Reduction:</strong> Using PCA for
visualization and understanding the clusters.</p>
<p><strong>Recommendation:</strong> Finding and recommending songs from
the same cluster.</p>
<p><strong>Evaluation:</strong> Comparing the recommended songs to the
original song using Euclidean distance and visualizing the results.</p>
</section>
<section id="final-conclusions" class="cell markdown" id="pOz4KLDMI6IG">
<h1>Final Conclusions</h1>
<h2 id="data-exploration">Data Exploration</h2>
<p><strong>Feature Distribution:</strong></p>
<p>Features such as energy, danceability, and loudness showed varied
distributions. Some features had normal distributions, while others were
skewed, indicating potential outliers or non-normality in the data.</p>
<p><strong>Correlation Analysis:</strong></p>
<p>A correlation matrix was created to identify the relationships
between different features. It was observed that some features had
significant correlations, such as energy and loudness, while others were
weakly correlated with the target variable (popularity).</p>
<p><strong>Missing Values and Outliers:</strong></p>
<p>The data was checked for missing values and outliers. Missing values
were handled through imputation or removal, ensuring the dataset was
clean for modeling. Models Various models were built and evaluated to
predict the target variable (popularity).</p>
<h2 id="the-models-included">The models included:</h2>
<p><strong>Linear Regression:</strong></p>
<p>Linear regression was used as a baseline model. While it provided
some insights, the R² scores indicated that it couldn't capture the
complexity of the dataset adequately.</p>
<p><strong>K-Means Clustering:</strong></p>
<p>K-Means clustering was employed to group the data into clusters based
on numerical features. The Silhouette Score was used to evaluate the
quality of the clusters, with a score of 0.186 indicating moderate
clustering performance. However, the clusters were not fully separated,
suggesting room for improvement.</p>
<p><strong>Random Forest and Other Advanced Models:</strong></p>
<p>Advanced models such as Random Forest were applied to enhance
prediction accuracy. These models showed improved performance compared
to linear regression, highlighting the importance of non-linear
relationships in the dataset.</p>
</section>
<div class="cell code" id="jpshFQsaETvM">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
